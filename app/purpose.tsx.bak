import { useRouter } from 'expo-router';
import React, { useState } from 'react';
import {
    Button,
    StyleSheet,
    Text,
    TouchableOpacity,
    View,
} from 'react-native';
import { useUserData } from '../context/UserDataContext';

const OPTIONS = [
  'מעקב אחרי מחזור',
  'להיכנס להריון',
  'הריון פעיל',
  'שמירה על הבריאות הכללית',
];

export default function PurposeScreen() {
  const router = useRouter();
  const { setGoal } = useUserData();
  const [selected, setSelected] = useState<string | null>(null);

  const handleNext = async () => {
    if (!selected) return;
    await setGoal(selected);
    router.push('/birthday');
  };

  return (
    <View style={styles.container}>
      <Text style={styles.title}>מה המטרה שלך?</Text>

      {OPTIONS.map(option => (
        <TouchableOpacity
          key={option}
          style={[
            styles.option,
            selected === option && styles.selectedOption,
          ]}
          onPress={() => setSelected(option)}
          activeOpacity={0.8}
        >
          <Text style={styles.optionText}>{option}</Text>
        </TouchableOpacity>
      ))}

      <View style={styles.nextButton}>
        <Button
          title="המשך"
          onPress={handleNext}
          disabled={!selected}
          color="#6a1b9a"
        />
      </View>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#fff',
    justifyContent: 'center',
    padding: 24,
  },
  title: {
    fontSize: 24,
    textAlign: 'center',
    marginBottom: 24,
    writingDirection: 'rtl',
  },
  option: {
    padding: 16,
    marginVertical: 8,
    borderWidth: 1,
    borderColor: '#6a1b9a',
    borderRadius: 12,
    backgroundColor: '#f3e5f5',
  },
  selectedOption: {
    backgroundColor: '#ce93d8',
  },
  optionText: {
    textAlign: 'center',
    fontSize: 18,
    writingDirection: 'rtl',
  },
  nextButton: {
    marginTop: 32,
  },
});
